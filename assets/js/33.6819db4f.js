(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{571:function(s,n,a){"use strict";a.r(n);var e=a(7),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h4",{attrs:{id:"编写shell过程中注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写shell过程中注意事项"}},[s._v("#")]),s._v(" 编写Shell过程中注意事项")]),s._v(" "),a("p",[s._v("1 开头加解释器：#!/bin/bash\n"),s._v("\n2 语法缩进，使用四个空格，多加注释说明")]),s._v(" "),a("p",[s._v("3 命名建议规则：变量名大写，局部变量小写，函数名小写，名字体现出实际作用。")]),s._v(" "),a("p",[s._v("4 默认变量是全局的，在函数中变量local指定为局部变量，避免污染其他作用域。")]),s._v(" "),a("p",[s._v("5 调试脚本命令：set -e 遇到执行非0时，退出脚本，set -x 打印执行过程。")]),s._v(" "),a("p",[s._v("6 写脚本一定先到测试环境，再到生产环境上。")]),s._v(" "),a("h5",{attrs:{id:"_1-、获取随机字符串或数字"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-、获取随机字符串或数字"}},[s._v("#")]),s._v(" 1 、获取随机字符串或数字")]),s._v(" "),a("p",[s._v("（1）获取随机8位字符串：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("方法1 \n# echo $RANDOM |  md5sum | cut -c 1-8\n方法2\n# openssl rand -base64 4\n方法3 \n# cat /proc/sys/kernel/random/uuid | cut -c 1-8\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("（2）获取随机8位数字")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("方法1 \n# echo $RANDOM | cksum | cut -c 1-8  //cksum：打印CRC校验和统计字节\n方法2 \n# openssl rand -base64 4 | cksum | cut 1-8\n方法3 \n# date +%N | cut -c 1-8\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h5",{attrs:{id:"_2、-定义一个颜色输出字符串函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、-定义一个颜色输出字符串函数"}},[s._v("#")]),s._v(" 2、 定义一个颜色输出字符串函数")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法1\nfunction echo_color() {\n​    if [ $1 == "green" ];then\n​        echo -e "\\033[32;40m$2\\033[0m"\n​    elif [ $1 == "red" ]; then\n​        echo -e "\\033[32;40m$2\\033[0m"\n   fi\n}\n\n方法2\nfunction echo_color() {\n​    case $1 in\n​        green)\n​            echo -e "[32;40m$2[0m"\n​            ;;\n​        red)\n​            echo -e "[32;40m$2[0m"\n​            ;;\n​        *)\n​            echo "Example:echo_color red string"\n​    esac\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h5",{attrs:{id:"_3-批量创建用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-批量创建用户"}},[s._v("#")]),s._v(" 3 批量创建用户")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#! /bin/bash\nDATE = $(date +%F_%T)\nUSER_FILE=user.txt\necho_color(){\n​    if [ $1 == "green" ];then\n​        echo -e "[32;40m$2[0m"\n​    elif [ $1 == "red" ];then\n​        echo -e "[32;40m$2[0m"\n​    fi\n}\n\n#如果用户文件存在并大小大于0就备份\nif [ -s $USER_FILE ]; then\n​    mv $USER_FILE ${USER_FILE}-${DATE}.bak\n​    echo_color green "$USER_FILE exist, rename ${USER_FILE}-${DATE}.bak"\nfi\necho -e "User Password" >> $USER_FILE\necho "----------" >> $USER_FILE\nfor USER in user{1..10};do\n​    if ! id $USER &>/dev/null; then\n​        PASS=$(echo $RANDOM | md5sum | cut -c 1-8)\n​        useradd $USER\n​        echo $PASS | password --stdin $USER &> /dev/null\n​        echo -e "$USER $PASS" >> $USER_FILE\n​        echo "$USER User create successful"\n​    fi\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h5",{attrs:{id:"_4-、检查软件包是否安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-、检查软件包是否安装"}},[s._v("#")]),s._v(" 4 、检查软件包是否安装")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\nif rpm -q sysstat &> /dev/null;then\n​    echo "sysstat is already installed"\nelse \n​    echo "sysstat is not installed"\nfi\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h5",{attrs:{id:"_5-、检查服务状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-、检查服务状态"}},[s._v("#")]),s._v(" 5 、检查服务状态")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\nPORT_C = $(ss -anu | grep -c 123)\nPS_C = $(ps -ef | grep ntpd | grep -vc grep)\nif [ $PORT_C -eq 0 -o $PS_C -eq 0 ]; then\n\t   echo "内容" | mail -s "主题"  dst@example.com\nfi\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h5",{attrs:{id:"_6-、检查主机存活状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-、检查主机存活状态"}},[s._v("#")]),s._v(" 6 、检查主机存活状态")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法1 ： 将错误的IP放到数组里面，判断是否ping失败三次\n#!/bin/bash\nIP_LIST = "192.168.18.1  192.168.1.1 192.168.18.2"\nfor IP in $IP_LIST ;do\n​    NUM = 1\n​    while [ $NUM -le 3 ]; do\n​        if ping -c 1 $IP > /dev/null; then\n​            echo "$IP ping is successful."\n​            break\n​        else \n​            \\# echo "$IP ping is failure $NUM"\n​            FAIL_COUNT[$NUM]=$IP\n​            let NUM++\n​        fi\n​    done\n​    if [ ${#FAIL_COUNT[*]} -eq 3 ] ; then\n​        echo "${FAIL_COUNT[1]} ping is failure" \n​        unset FAIL_COUNT[*]\n​    fi\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法2：将错误次数放到FAIL_COUNT变量里面判断是否ping失败三次\n#!/bin/bash\nIP_LIST = "192.168.18.1 192.168.1.1 192.168.28.2"\nfor IP in $IP_LIST ; do\n​    FAIL_COUNT=0\n​    for ((i=1;i<=3;i++));do\n​        if ping -c 1 $IP > /dev/null; then\n​            echo "$IP ping is successful"\n​            break\n​        else\n​            \\# echo "$IP ping is failure $i"\n​            let FAIL_ COUNT++\n​        fi\n​    done\n​    if [ $FAIL_COUNT -eq 3 ]; then\n​        echo "$IP ping is failure"\n​    fi\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法3 ：利用for循环将ping通就跳出循环继续，如果不跳出就会打印ping失败。\n#!/bin/bash\nping_success_status() {\n​    if ping -c 1 $IP > /dev/null; then\n​        echo "$IP ping is successful"\n​        continue\n​    fi\n}\nIP_LIST = "192.168.18.1  192.168.1.1 192.168.18.2"\nfor IP in $IP_LIST ; do\n​    ping_success_status\n​    ping_success_status\n​    ping_success_status\n​    echo "$IP ping is failure"\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h5",{attrs:{id:"_7、-监控cpu、内存和硬盘利用率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7、-监控cpu、内存和硬盘利用率"}},[s._v("#")]),s._v(" 7、 监控CPU、内存和硬盘利用率")]),s._v(" "),a("p",[s._v("（1）CPU")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('借助vmstat 工具来分析CPU统计信息\n#!/bin/bash\nDATE=$(date +%H:%M)\nIP=$(ifconfig eth0 | awk -F [  : ]+ /inet addr/{print $4}) # 只支持Centos6\nMAIL="example@mail.com"\nif ! which vmstat &> /dev/null; then\n​    echo "vmstat command no found , Please install procps package"\n​    exit 1\nfi\nUS = $(vmstat | awk NR==3{print $13})\nSY = $(vmstat | awk NR==3{print $14})\nIDLE = $(vmstat | awk NR==3{print $15})\nWAIT = $(vmstat | awk NR==3{print $16})\nUSE = $(($US+$UY))\nif [ $USE -ge 50 ];then\n​    echo "\n​    Date: $DATE\n​    Host: $IP\n​    Problem: CPU utilization $USE\n​    "  | mail -s "CPU Monitor" $MAIL\nfi\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("（2）内存")]),s._v(" "),a("p",[s._v("​")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(' #!/bin/bash\n​     DATE = $(date +%F""%H:%M)\n​     IP = $(ifconfig eth0 | awk -F [ : ]+ /inet addr/{print $4} )\n​     MAIL = "example@mail.com"\n​     TOTAL = $(free -m | awk /Mem/{print $2} )\n​     USE = $(free -m | awk /Mem/{print $3-$6-$7} )\n​     FREE = $(($TOTAL-$USE))\n# 内存小于1G，发送报警邮件\n if [ $FREE -lt 1024 ]; then\n​     echo "\n​     Date : $DATE\n​     Host : $IP\n​     Problem : Total=$TOTAL,Use=$USE,Free=$FREE\n​     "  | mail -s "Memory Monitor" $MAIL\n if\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("（3）硬盘")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\nDATE = $(date +%F" "%H:%M)\nIP = $(ifconfig eth0 | awk -F [ : ]+ /inet addr/{print $4})\nMAIL = "example@mail.com"\nTOTAL =  $(fdisk -l | awk -F [ : ]+ BEGIN{OFS="="}/^Disk /dev/{printf "%s=%sG,",$2,$3})\nPART_USE = $(df -h | awk BEGIN{OFS="="}/^/dev/{print $1,int($5),$6})\nfor i in $PART_USE; do\n​    PART = $(echo $i | cut -d "=" -f1)\n​    USE = $(echo $i | cut -d "=" -f2)\n​    MOUNT = $(echo $i | cut -d "=" -f3)\n​    if [ $USE -gt 80 ]; then\n​        echo "\n​        Date : $DATE\n​        Host : $IP\n​        Total : $TOTAL\n​        Problem : $PART=$USE($MOUNT)\n​        "  |  mail -s "Disk Monitor" $MAIL\n​    fi\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h5",{attrs:{id:"_8、-批量主机磁盘利用率监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8、-批量主机磁盘利用率监控"}},[s._v("#")]),s._v(" 8、 批量主机磁盘利用率监控")]),s._v(" "),a("p",[s._v("前提监控端和被监控端SSH免交互登录或者密钥登录")]),s._v(" "),a("p",[s._v("写一个配置文件保存被监控主机SSH连接信息，文件内容格式： IP User Port")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\nHOST_INFO = host.info\nfor IP in $(awk /^[^#]/{print $1} $HOST_INFO); do\n​    USER = $(awk -v ip=$IP ip==$1{print $2} $HOST_INFO)\n​    PORT = $(awk -v ip=$IP ip==$1{print $3} $HOST_INTO)\n​    TMP_FILE=/tmp/disk.tmp\n​    ssh -p $PORT $USER@$IP df -h > $TMP_FILE\n​    USE_RATE_LIST = $(awk BEGIN{OFS= "="}/^/dev/{print $1,int($5)} $TMP_FILE)\n​    for USE_RATE in $USE_RATE_LIST; do\n​         PART_NAME = ${USE_RATE%=*}\n​         USE_RATE = ${USE_RATE#*=}\n​         if [ $USE_RATE -ge 80  ]; then\n​             echo "Warning: $\tPART_NAME Partition usage $USE_RATE%!"\n​         fi\n​     done\n done\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h5",{attrs:{id:"_9、-检查网站可用性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9、-检查网站可用性"}},[s._v("#")]),s._v(" 9、 检查网站可用性")]),s._v(" "),a("p",[s._v("（1）检查URL可用性")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法1\ncheck_url() {\n​    HTTP_CODE = $(curl -o /dev/null --connect-timeout 3 -s -w "%{http_code}" $1)\n​    if [ $HTTP_CODE -ne 200 ]; then\n​        echo "Warning: $1 Access failure"\n​    fi\n​    }\n\n方法2\ncheck_url(){\n​    if ! wget -T 10 --tries=1 --spider $1 >/dev/null 2>&1; then\n​    \\#-T 超时时间，--tries尝试1次，--spider爬虫模式\n​        echo "Warnin : $1 Access failure"\n​    fi\n​    }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("（2）判断三次URL可用性")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法1：利用循环技巧，如果成功就跳出当前循环，否则执行都最后一行\n#!/bin/bash\ncheck_url(){\n​    HTTP_CODE = $(curl -o /dev/null --connect-timeout 3 -s -w "%{http_code}" $1)\n​    if [ $HTTP_CODE -eq 200 ]; then\n​        continue\n​    fi\n}\nURL_LIST = "www.baidu.com  www.runoob.com"\nfor URL in $URL_LIST; do\n​    check_url $URL\n​    check_url $URL\n​    check_url $URL\n​    echo "Warning : $URL Access failure"\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法2：错误次数保存到变量\n\n#!/bin/bash\nURL_LIST = "www.baidu.com  www.runoob.com"\nfor URL in $URL_LIST; do\n​    FAIL_COUNT = 0\n​    for ((i=1;i<=3;i++)); do\n​        HTTP_CODE = $(curl -o /dev/null --connect-timeout 3 -s -w "%{http_code}" $URL)\n​        if [ $HTTP_CODE -ne 200 ]; then\n​            let FAIL_CONUT++\n​        else\n​           break\n​        fi\n​    done\n​    if [ $FAIL_COUNT -eq 3 ]; then\n​        echo "Warning : $URL Access failure"\n​    if\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法3：错误次数保存到数组\n#!/bin/bash\nURL_LIST = "www.baidu.com  www.runoob.com"\nfor URL in $URL_LIST ; do\n​    NUM = 1\n​    while [  $NUM -le 3 ] ; do\n​        HTTP_CODE= $(curl -o /dev/null --connect-timeout 3 -s -w "%{http_code}" $URL) \n​        if [ $HTTP_CODE -ne 200 ]; then\n​            FAIL_COUNT[$NUM]=$IP #创建数组，以$NUM下标，$IP元素\n​            let NUM++\n​        else\n​            break\n​        fi\n​    done\n​    if [ ${#FAIL_COUNT[*]}  -eq 3]; then\n​        echo "Warning : $URL Access failure"\n​        unset FAIL_COUNT[*] #清空数组\n​    if\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h5",{attrs:{id:"_10、-iptables自动屏蔽访问网站频繁的ip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10、-iptables自动屏蔽访问网站频繁的ip"}},[s._v("#")]),s._v(" 10、 iptables自动屏蔽访问网站频繁的IP")]),s._v(" "),a("h5",{attrs:{id:"场景-恶意访问-安全防范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#场景-恶意访问-安全防范"}},[s._v("#")]),s._v(" 场景：恶意访问，安全防范")]),s._v(" "),a("p",[s._v("（1）屏蔽每分钟访问超过200的IP")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法1 ：根据访问日志（Nginx为例）\n#!/bin/bash\nDATE = $(date +%d/%b/%Y:%H:%M)\nABNORMAL_IP = $(tail -n5000 access.log | grep $DATE | awk \'{a[$1]++}END{for(i in a)if(a[i]>100)print i}\')\n\n#先tail 访问 文件过大，读取慢，数字可调整每分钟最大的访问量。awk不能直接过滤日志，因为包含特殊字符\nfor IP in $ABNORMAL_IP; do\n​    if [ $(iptables -vnL | grep -c "$IP") -eq 0 ];then\n​        iptables -I INPUT -s $IP -j DROP\n​    if\ndone\n\n方法2：通过TCP建立的连接\n#!/bin/bash\nABNORMAL_IP = $(netstat -an | awk \'$4~/:80$/ && $6~/ESTABLISHED/{gsub(/:[0-9]+/,"",$5);{a[$5]++}}END{for(i in a)if(a[i]>100)print i}\')\n#gsub是将第五列（客户端IP）的冒号和端口去掉\nfor IP in $ABNORMAL_IP ; do\n​    if [  $(iptables -vnL | grep -c "$IP") -eq 0 ]; then\n​        iptables -I INPUT -s $IP -j DROP\n​    if\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("（2）屏蔽每分钟SSH尝试登录超过10次的IP")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法1：通过lastb获取登录状态\n\n#!/bin/bash\nDATE = $(date +"%a %b %e %H:%M") #星期月天时分， %e单数字时显示7，而%d显示07\nABNORMAL_IP = $IP(lastb | grep "DATE" | awk \'{a[$3]++}END{for(i in a)if(a[i]>10)print i}\')\nfor IP in $ABNORMAL_IP ; do\n   if [  $(iptables -vnL | grep -c "$IP") -eq 0 ]; then\n\n      iptables -I INPUT -s $IP -j DROP\n   fi\ndone\n\n方法2：通过日志获取登录状态\n#!/bin/bash\nDATE = $(date +"%b %d %H")\nABNORMAL_IP = "$(tail -n10000 /var/log/auth.log | grep "$DATE\t" | awk \'/Failed/{a[$(NF-3)]++}END{for(i in a)if(a[1]>5)print j}\')"\n\nfor IP in $ABNORMAL_IP ; do\n    if [ $(iptables -vnL | grep -c "$IP") -eq 0 ];then\n        iptables -A INPUT -s $IP -j DROP\n        echo "$(date +%F %T) - iptables -A INPUT -s $IP -j DROP" >>~/ssh-login-limit.log\n    fi\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("11、 判断用户输入的是否为IP地址")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\nfunction check_ip(){\n​    local IP = $1\n​    VALID_CHECK = $(echo $IP | awk -F . \'$1<=255&&$2<=255&&$3<=255&&$4<=255{print "yes"}\')\n​    if echo $IP | grep -E "^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$" >/dev/null; then\n​        if [ $VALID_CHECK == "yes" ]; then\n​            return 0\n​        else\n​            echo "$IP not available"\n​               return 1\n​        fi\n​    else \n​        echo "Format error , Please input again"\n​         return 1\n​    fi\n}\n\n#死循环作用：如果IP可用就退出，不可用就提示继续输入，并使用awk判断。\nwhile true ; do       \n​    read -p "Please enter IP:" IP\n​    check_ip $ip\n​    [ $? -eq 0 ]  && break || continue\ndone\n\ncheck_ip 192.168.1.2\ncheck_ip 256.1.1.1\n\n方法2：\n#!/bin/bash\nfunction check_ip(){\n​    IP = $1\n​    if [[ $IP =~ ^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$ ]]; then\n​        FIELD1 = $(echo $IP | cut -d. -f1)\n​        FIELD2 = $(echo $IP | cut -d. f2)\n​        FIELD3 = $(echo $IP | cut -d. f3)\n​        FIELD4 = $(echo $IP | cut -d. -f4)\n​        if [ $FIELD1 -le 255 -a $FIELD2 -le 255 -a $FIELD3 -le 255 -a $FIELD4 -le 255 ]; then\n​            echo "$IP available"\n​        else \n​           echo "$IP not available"\n​        fi\n​    else\n​        echo "Format error"\n​    fi\n}\n\ncheck_ip 192.168.1.1\ncheck_ip 256.1.1.1\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br")])]),a("p",[s._v("12、判断用户输入的是否为数字")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法1\n#!/bin/bash\nif [[ $1 =~ ^[0-9]+$ ]]; then\n​    echo "Is Number"\nelse \n​    echo "No Number"\nfi\n\n方法2\n#!/bin/bash\nif [ $1 -gt 0 ]  2> /dev/null; then\n​    echo "Is Number"\nelse\n​    echo "No Number"\nfi\n\n方法3\n#!/bin/bash\necho $1 | awk \'{print $0~/^[0-9]+$/? "Is Number.":"No Number"}\'\nDIR = $1\nKEY\t = $2\nfor FILE in $(find $DIR -type f); do\n​    if grep $KEY $FILE &> /dev/null ; then\n​        echo "---\x3e $FILE"\n​    fi\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("p",[s._v("13 、给定目录找出包含关键字的文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\nDIR = $1\nKEY = $2\nfor  FILE in $(find $DIR -type f) ; do\n​    if grep $KEY $FILE &> /dev/null ; then\n​        echo "---\x3e $FILE"\n​    fi\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("14 、监控目录，将新创建的文件名追加到日志中")]),s._v(" "),a("p",[s._v("场景：记录目录下文件操作。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("需要先安装inotify-tools软件包\n#!/bin/bash\nMON_DIR = /opt\ninotifywait -mq --format %f -e create $MON_DIR | \\\nwhile read files; do\n​    echo $files >> test.log\ndone\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("15、 给用户提供多个网卡选择")]),s._v(" "),a("p",[s._v("场景：服务器多个网卡时，获取指定网卡，例如网卡流量")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\nfunction local_nic() {\n​    local NUM ARRAY_LENGTH\n​    NUM = 0\n​    for NIC_NAME in $(ls /sys/class/net | grep -vE "lo | docker0"); do\n​        NIC_IP = $(ifconfig $NIC_NAME | awk -F \'[ : ]+\'  \'/inet addr/{print $4}\')\n​        if [ -n "$NIC_IP" ]; then\n​            NIC_IP_ARRAY[$NUM]="$NIC_NAME:$NIC_IP" #将网卡名和对应的IP放到数组\n​            let NUM++\n​        fi\n​    done\n\n​    ARRAY_LENGTH = ${#NIC_IP_ARRAY[*]}\n​    if [ $ARRAY_LENGTH -eq 1 ]; then  #如果数组里面只有一条记录，说明就一个网卡\n​        NIC = ${NIC_IP_ARRAY[0]%:*}\n​        return 0\n​    elif [ $ARRAY_LENGTH -eq 0 ]; then #如果没有记录，说明没有网卡\n​        echo "No available network card"\n​        exit 1\n\n​    else\n​        #如果有多条记录，则提醒输入选择\n​        for NIC in ${NIC_IP_ARRAY[*]}; do\n​            echo $NIC\n​        done\n​        while true; do\n​            read -p "Please enter local use to network card name:"  INPUT_NIC_NAME\n​            COUNT = 0\n​            for NIC in ${NIC_IP_ARRAY[*]}; do\n​                NIC_NAME = ${NIC%:*}\n​                if [ $NIC_NAME == "$INPUT_NIC_NAME" ] ; then\n​                    NIC = ${NIC_IP_ARRAY[$COUNT]%:*}\n​                    return 0\n​                else\n​                    COUNT+=1\n​                fi\n​            done\n​          \t\t\t  echo "Not match! Please input again"\n​        done\n​    fi\n}\n\nlocal_nic\n\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br")])]),a("p",[s._v("16、查看网卡实时流量")]),s._v(" "),a("p",[s._v("适用于CentOS6操作系统")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#!bin/bash\n\n#Description:only CentOS6\ntraffic_unit_conv() {\n  local traffic = $1\n  if [ $traffic -gt 1024000 ] ; then\n​    printf \"%.1f%s\" \"$(($traffic/1024/1024))\"  \"MB/s\"\n  elif [ $traffic -lt 1024000 ] ; then\n​    printf \"%.1f%s\" \"$(($traffic/1024))\" \"KB/s\"\n  fi\n}\n\nNIC = $1\n\necho -e \" In ------ out \"\n\nwhile true; do\n  OLD_IN = $(awk -F '[: ]+'  '$0~  \" '$NIC' \" {print $3}' /proc/net/dev)\n  OLD_OUT = $(awk -F '[: ]+'  '$0~  \" '$NIC' \" {print $11}' /proc/net/dev)\n  sleep 1\n  NEW_IN = $(awk -F '[: ]+'  '$0~  \" '$NIC' \" {print $3}' /proc/net/dev)\n  NEW_OUT = $(awk -F '[: ]+'  '$0~  \" '$NIC' \" {print $11}' /proc/net/dev)\n  IN = $(($NEW_IN-$OLD_IN))\n  OUT = $(($NEW_OUT-$OLD_OUT))\n  echo \"$(traffic_unit_conv $IN)  $(traffic_unit_conv $OUT)\"\n  sleep 1\ndone\n\n使用: ./traffic.sh  eth0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("p",[s._v("17 、MySQL数据库备份")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\nDATE = $(date +%F_%H-%M-%s)\nHOST = 192.168.1.1\nDB = test\nUSER = bak\nPASS = 123\nMAIL = "lincy@example.com"\nBACKUP_DIR = /data/db_backup\nSQL_FILE = ${DB}_full_$DATE.sql\nBAK_FILE = ${DB}_full_$DATE.zip\ncd $BACKUP_DIR\n\nif mysqldump -h$HOST -u$USER  -pPASS  --single-transaction  --routines  --triggers -B $DB > $SQL_FILE;then\n\n  zip $BAK_FILE  $SQL_FILE  && rm -f $SQL_FILE\n  if [ ! -s $BAK_FILE ]; then\n​    echo "$DATE 内容"  |  mail -s "主题"  $MAIL\n  if\nelse\n  echo "$DATE 内容"  | mail -s "主题"  $MAIL\nfi\nfind $BACKUP_DIR -name \'*.zip\'  -ctime  +14 -exec  rm {}  \\;\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("18、 从FTP服务器下载文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\n\nif [ $# -ne 1 ] ; then\n\n​    echo "Usage: $0 filename"\n\nfi\n\ndir = $(dirname $1)\n\nfile = $(basename $1)\n\nftp -n -v << EOF    # -n 自动登录\n\nopen 192.168.1.1  # ftp 服务器\n\nuser admin password\n\nbinary #设置ftp传输模式为二进制，避免MD5值不同或.tar.gz压缩包格式错误\n\ncd $dir\n\nget "$file"\n\nEOF\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("19、 连续输入5个100以内的数字，统计和、最小和最大")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\nCOUNT = 1\nSUM = 0\nMIN = 0\nMAX = 0\n\nwhile [ $COUNT -le 5 ];do\n​    read -p "请输入1-10个整数：" INT\n​    if [[  ! $INT =~ ^[0-9]+$  ]]; then\n​        echo "输入必须是整数" \n​        exit 1\n​    elif [[  $INT -gt 100  ]]; then\n​        echo "输入必须是100以内"\n​        exit 1 \n​    fi\n\n​    SUM = $($SUM+$INT)\n​    [  $MIN -lt $INT  ]  && MIN = $INT\n​    [  $MAX -gt $INT  ] && MAX = $INT\n​    let COUNT++\ndone\n    echo "SUM:$SUM"\n    echo "MIN: $MIN"\n    echo "MAX:$MAX"\n\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("p",[s._v("20、 将结果分别赋值给变量")]),s._v(" "),a("p",[s._v("应用场景，希望将执行结果或者位置参数赋值给变量，以便后续使用")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('方法一\n\nfor i in $(echo "4 5 6");do\n​    eval a$i = $i\ndone\necho $a4 $a5 $a6\n\n\n方法二：将位置参数192.168.1.1{1，2}拆分为到每个变量\nnum = 0 \nfor i in $(eval echo $*);do\n​    let num+=1\n​    eval node${num}="$i"\ndone\necho $node1 $node2 $node3\n#bash a.sh 192.168.1.1{1,2}\n192.168.1.11 192.168.1.12\n\n\n方法三\narr = (4 5 6)\nINDEX1 = $(echo ${arr[0]})\nINDEX2 = $(echo ${arr[1]})\nINDEX3 = $(echo ${arr[2]})\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[s._v("21、 批量修改文件名")]),s._v(" "),a("p",[s._v("示例：")]),s._v(" "),a("p",[s._v("# touch article_{1..3}.html")]),s._v(" "),a("p",[s._v("ls")]),s._v(" "),a("p",[s._v("目的：把article改为bbs")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("方法一\n\nfor file in $(ls *html); do\n​    mv $file bbs_${file#*_}\n​    \\#mv $file $(echo $file | sed -r 's/.*(_.*)/bbs\\1/')\n​    \\#mv $file $(echo $file | echo bbs_$(cut -d_ -f2))\ndone\n\n方法二\n\nfor file in $(find . -maxdepth 1 -name \"*html\");do\n​    mv $file bbs_${file#*_}\ndone\n\n方法三\n\nrename article bbs *.html\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[s._v("22、 统计当前目录中以.html结尾的文件大小")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("方法一\n\n\\# find . -name \"*.html\" -exec du -k {} \\;  | awk '{sum+=$1}END{print sum}'\n\n方法二\n\nfor size in $(ls -l *.html | awk '{print $5}');do\n​    sum = $(($sum + $size))\ndone \necho $sum\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("23、 扫描主机端口状态")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\n\nHOST = $1\nPORT = "22 25 80 8080"\nfor PORT in $PORT ; do\n​    if echo &>/dev/null > /dev/tcp/$HOST/$PORT;then\n​        echo "$PORT open"\n​    else\n​        echo "$PORT close"\n​    fi\ndone\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);