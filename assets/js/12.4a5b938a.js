(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{524:function(s,a,e){s.exports=e.p+"assets/img/clipboard.60fde8b9.png"},525:function(s,a,e){s.exports=e.p+"assets/img/clipboard_02.0216db20.png"},526:function(s,a,e){s.exports=e.p+"assets/img/clipboard_03.904efb6d.png"},556:function(s,a,e){"use strict";e.r(a);var t=e(7),r=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"一、物理机配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、物理机配置"}},[s._v("#")]),s._v(" 一、物理机配置")]),s._v(" "),t("p",[s._v("1、 修改内核模式为兼容内核启动")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("vim /boot/grub/grub.conf \n主要修改default=1 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("2.查看cpu是否支持全虚拟化")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("egrep '(vmx|svm)' /proc/cpuinfo \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"二、安装必要的程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、安装必要的程序"}},[s._v("#")]),s._v(" 二、安装必要的程序")]),s._v(" "),t("p",[s._v("1、必要的安装包")]),s._v(" "),t("p",[t("img",{attrs:{src:e(524),alt:"An image"}})]),s._v(" "),t("p",[s._v("检查这些包是否安装")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("rpm -q qemu-kvm libvirt python-virtinst virt-viewer virt-manager bridge-utils \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("没有安装则安装这些包")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("yum -y install qemu-kvm libvirt python-virtinst virt-viewer virt-manager bridge-utils \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("2、重启libvirt服务：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("service libvirtd restart\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"三、创建桥接网卡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、创建桥接网卡"}},[s._v("#")]),s._v(" 三、创建桥接网卡")]),s._v(" "),t("p",[s._v("1、创建桥接网卡br0")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("virsh iface-bridge em1 br0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("#虚拟网桥配置 (不能自己创建编辑，后续会出问题)")]),s._v(" "),t("p",[s._v("2、为了使KVM的虚拟机可以使用同一网段内网，配置虚拟网桥")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("首先关闭NetworkManager(此服务会使配置无效) \nservice NetworkManager stop \nchkconfig NetworkManager off \nservice NetworkManager status \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("创建网桥br0")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cp /etc/sysconfig/network-scripts/ifcfg-eth0 /etc/sysconfig/network-scripts/ifcfg-br0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("修改网卡文件及网桥文件")]),s._v(" "),t("p",[t("img",{attrs:{src:e(525),alt:"An image"}})]),s._v(" "),t("p",[s._v("重启网络服务")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("service network restart(必须在关闭了NetworkManager后) \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"四、修改kvm中image文件存放的位置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、修改kvm中image文件存放的位置"}},[s._v("#")]),s._v(" 四、修改KVM中image文件存放的位置")]),s._v(" "),t("p",[s._v("KVM虚拟机默认image文件存放位置为/var/lib/libvirt/images目录下一般在分区时很少为/var单独划出一个大分区，这种情况下创建的虚拟机很快会将/分区吃满，所以机器要使用KVM虚拟机化的时候，我们先单独规划出一个分区用来放image文件。")]),s._v(" "),t("p",[s._v("比如这里我们规划/data/kvmimages目录用来放images文件。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/etc/libvirt/storage/default.xml   #这个是默认的存放路径配置文件\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("需要使用如下命令编辑：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("virsh pool-edit default    #（直接使用vi编辑是不生效的,另外服务重启才生效）\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("把/var/lib/libvirt/images修改成/data/kvmimage\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("#并重启libvirt服务\nservice libvirtd restart\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"五、启动虚拟系统管理器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、启动虚拟系统管理器"}},[s._v("#")]),s._v(" 五、启动虚拟系统管理器")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("1、启动libvirt服务\nservice libvirtd start \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("2、在图形端点开虚拟系统管理器即可新建虚拟机了，我这边遇到了一个启动器出错的错误")]),s._v(" "),t("p",[t("img",{attrs:{src:e(526),alt:"An image"}})]),s._v(" "),t("p",[s._v("出错原因是版本问题\n查看Virt-Manager版本\n通过命令：virt-manager --version查看Virt-Manager版本为：0.9.0（小版本为0.9.0-34）\n卸载掉版本为0.9.0的")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("rpm -e --nodeps virt-manager-0.9.0-34.el6.x86_64\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("上传下载好的其余版本的Virt-Manager\n（链接：https://pan.baidu.com/s/1g4d7f7qdAjvkO_rxGxrIQA 提取码：1234 ）\n安装")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("rpm -ivh virt-manager-0.9.0-31.el6.x86_64.rpm\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("重启libvirt服务即可： \nservice libvirtd restart \n设置服务为开机自启动\nchkconfig libvirtd on\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("#查看运行中的虚拟机\nvirsh  list\n#查看所有虚拟机\nvirsh  list --all\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("启动，关闭和重启一个虚拟机\nvirsh start name\nvirsh shutdown name\nvirsh reboot name\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("Valine")],1)}),[],!1,null,null,null);a.default=r.exports}}]);