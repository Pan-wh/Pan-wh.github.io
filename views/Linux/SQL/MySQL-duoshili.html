<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mysql多实例配置 | 蚝仔烙</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="This is the personal blog of oyster">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.f7db033e.css" as="style"><link rel="preload" href="/assets/js/app.cb239607.js" as="script"><link rel="preload" href="/assets/js/3.b5031865.js" as="script"><link rel="preload" href="/assets/js/1.21311c90.js" as="script"><link rel="preload" href="/assets/js/21.382df535.js" as="script"><link rel="preload" href="/assets/js/15.f0eedfb9.js" as="script"><link rel="prefetch" href="/assets/js/10.07217ceb.js"><link rel="prefetch" href="/assets/js/11.7dcea16d.js"><link rel="prefetch" href="/assets/js/12.4a5b938a.js"><link rel="prefetch" href="/assets/js/13.2ec8b12e.js"><link rel="prefetch" href="/assets/js/14.85b8f9a3.js"><link rel="prefetch" href="/assets/js/16.60f0a9eb.js"><link rel="prefetch" href="/assets/js/17.51743234.js"><link rel="prefetch" href="/assets/js/18.19a85d64.js"><link rel="prefetch" href="/assets/js/19.f2c9559a.js"><link rel="prefetch" href="/assets/js/20.e8956008.js"><link rel="prefetch" href="/assets/js/22.cff47005.js"><link rel="prefetch" href="/assets/js/23.398482ee.js"><link rel="prefetch" href="/assets/js/24.d630b366.js"><link rel="prefetch" href="/assets/js/25.275780ab.js"><link rel="prefetch" href="/assets/js/26.23e5b2b0.js"><link rel="prefetch" href="/assets/js/27.77924f3d.js"><link rel="prefetch" href="/assets/js/28.154c79c8.js"><link rel="prefetch" href="/assets/js/29.d17c191b.js"><link rel="prefetch" href="/assets/js/30.aa5d257a.js"><link rel="prefetch" href="/assets/js/31.12a80f6c.js"><link rel="prefetch" href="/assets/js/32.ba8121ce.js"><link rel="prefetch" href="/assets/js/33.6819db4f.js"><link rel="prefetch" href="/assets/js/34.0dbf4641.js"><link rel="prefetch" href="/assets/js/35.312f1271.js"><link rel="prefetch" href="/assets/js/36.0f0b6a1b.js"><link rel="prefetch" href="/assets/js/4.5240f799.js"><link rel="prefetch" href="/assets/js/5.ee618cb0.js"><link rel="prefetch" href="/assets/js/6.ffe3abe9.js"><link rel="prefetch" href="/assets/js/7.01f76950.js"><link rel="prefetch" href="/assets/js/8.4f1544dc.js"><link rel="prefetch" href="/assets/js/9.25ddbd8c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f7db033e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>蚝仔烙</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>This is the personal blog of oyster</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>蚝仔烙</span>
            
          <!---->
          2021
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/head.png" alt="蚝仔烙" class="logo"> <span class="site-name">蚝仔烙</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  家
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/docker/" class="nav-link"><i class="undefined"></i>
  docker
</a></li><li class="dropdown-item"><!----> <a href="/categories/KVM/" class="nav-link"><i class="undefined"></i>
  KVM
</a></li><li class="dropdown-item"><!----> <a href="/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/categories/grafana/" class="nav-link"><i class="undefined"></i>
  grafana
</a></li><li class="dropdown-item"><!----> <a href="/categories/zabbix/" class="nav-link"><i class="undefined"></i>
  zabbix
</a></li><li class="dropdown-item"><!----> <a href="/categories/nginx/" class="nav-link"><i class="undefined"></i>
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/categories/selinux/" class="nav-link"><i class="undefined"></i>
  selinux
</a></li><li class="dropdown-item"><!----> <a href="/categories/redis/" class="nav-link"><i class="undefined"></i>
  redis
</a></li><li class="dropdown-item"><!----> <a href="/categories/shell/" class="nav-link"><i class="undefined"></i>
  shell
</a></li><li class="dropdown-item"><!----> <a href="/categories/黑苹果/" class="nav-link"><i class="undefined"></i>
  黑苹果
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/head.png" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    蚝仔烙
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>24</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>15</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  家
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Linux/" class="nav-link"><i class="undefined"></i>
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/categories/docker/" class="nav-link"><i class="undefined"></i>
  docker
</a></li><li class="dropdown-item"><!----> <a href="/categories/KVM/" class="nav-link"><i class="undefined"></i>
  KVM
</a></li><li class="dropdown-item"><!----> <a href="/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/categories/grafana/" class="nav-link"><i class="undefined"></i>
  grafana
</a></li><li class="dropdown-item"><!----> <a href="/categories/zabbix/" class="nav-link"><i class="undefined"></i>
  zabbix
</a></li><li class="dropdown-item"><!----> <a href="/categories/nginx/" class="nav-link"><i class="undefined"></i>
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/categories/selinux/" class="nav-link"><i class="undefined"></i>
  selinux
</a></li><li class="dropdown-item"><!----> <a href="/categories/redis/" class="nav-link"><i class="undefined"></i>
  redis
</a></li><li class="dropdown-item"><!----> <a href="/categories/shell/" class="nav-link"><i class="undefined"></i>
  shell
</a></li><li class="dropdown-item"><!----> <a href="/categories/黑苹果/" class="nav-link"><i class="undefined"></i>
  黑苹果
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Mysql多实例配置</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>蚝仔烙</span>
            
          <!---->
          2021
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">Mysql多实例配置</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>转自民工哥</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>5/26/2021</span></i> <!----> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>Linux</span><span class="tag-item" data-v-1ff7123e>数据库</span><span class="tag-item" data-v-1ff7123e>Mysql</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="_1、什么是多实例"><a href="#_1、什么是多实例" class="header-anchor">#</a> 1、什么是多实例</h2> <p>多实例就是一台服务器上开启多个不同的服务端口（默认3306），运行多个mysql的服务进程，这此服务进程通过不同的socket监听不同的服务端口来提供各在的服务，所有实例之间共同使用一套MYSQL的安装程序，但各自使用不同的配置文件、启动程序、数据文件，在逻辑上是相对独立的。</p> <p>​    多实例主要作用是：充分利用现有的服务器硬件资源，为不同的服务提供数据服务，但是如果某个实例并发比较高的，同样是会影响到其它实例的性能</p> <h2 id="_2、安装多实例环境准备"><a href="#_2、安装多实例环境准备" class="header-anchor">#</a> 2、安装多实例环境准备</h2> <p>安装前需要先安装mysql，但是只需将安装过程进行到make install即可（编译安装），如果使用免安装程序，只需解压软件包即可，今天的环境是通过免安装包来安装mysql主程序（其它的安装可以参考前面的安装过程自行测试）</p> <h3 id="安装程序"><a href="#安装程序" class="header-anchor">#</a> 安装程序</h3> <p>mysql-5.5.52-linux2.6-x86_64.tar.gz</p> <p>首先将软件下载到本地</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>wget http://mirrors.sohu.com/mysql/MySQL-5.5/mysql-5.5.52-linux2.6-x86_64.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="创建安装用户"><a href="#创建安装用户" class="header-anchor">#</a> 创建安装用户</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@centos6 ~]#groupadd mysql
[root@centos6 ~]#useradd mysql -s /sbin/nologin -g mysql -M
[root@centos6 ~]#tail -1 /etc/passwd
mysql:x:500:500::/home/mysql:/sbin/nologin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="创建多实例的数据目录"><a href="#创建多实例的数据目录" class="header-anchor">#</a> 创建多实例的数据目录</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@centos6 tools]# mkdir -p /data/{3306,3307}
[root@centos6 tools]# tree /data/
/data/
+-- 3306
+-- 3307
2 directories, 0 files
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_3、安装mysql多实例"><a href="#_3、安装mysql多实例" class="header-anchor">#</a> 3、安装MYSQL多实例</h2> <p>接下来进行安装mysql的多实例操作</p> <h3 id="解压软件"><a href="#解压软件" class="header-anchor">#</a> 解压软件</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@centos6 tools]# ll mysql-5.5.52-linux2.6-x86_64.tar.gz 
-rw-r--r--. 1 root root 185855000 Aug 26 21:38 mysql-5.5.52-linux2.6-x86_64.tar.gz
[root@centos6 tools]# tar zxf mysql-5.5.52-linux2.6-x86_64.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="拷贝配置文件"><a href="#拷贝配置文件" class="header-anchor">#</a> 拷贝配置文件</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@centos6 mysql-5.5.52-linux2.6-x86_64]# cp support-files/my-small.cnf /data/3306/my.cnf
[root@centos6 mysql-5.5.52-linux2.6-x86_64]# cp support-files/mysql.server /data/3306/mysql
[root@centos6 mysql-5.5.52-linux2.6-x86_64]# cp support-files/my-small.cnf /data/3307/my.cnf
[root@centos6 mysql-5.5.52-linux2.6-x86_64]# cp support-files/mysql.server /data/3307/mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>为一规范安装路径，将免安装包拷贝到应用程序目录下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@centos6 tools]# mv mysql-5.5.52-linux2.6-x86_64 /application/mysql
[root@centos6 tools]# ll /application/mysql
total 72
drwxr-xr-x.  2 root root   4096 Dec  9 17:15 bin
-rw-r--r--.  1 7161 31415 17987 Aug 26 19:24 COPYING
drwxr-xr-x.  3 root root   4096 Dec  9 17:15 data
drwxr-xr-x.  2 root root   4096 Dec  9 17:15 docs
drwxr-xr-x.  3 root root   4096 Dec  9 17:15 include
-rw-r--r--.  1 7161 31415   301 Aug 26 19:24 INSTALL-BINARY
drwxr-xr-x.  3 root root   4096 Dec  9 17:15 lib
drwxr-xr-x.  4 root root   4096 Dec  9 17:15 man
drwxr-xr-x. 10 root root   4096 Dec  9 17:15 mysql-test
-rw-r--r--.  1 7161 31415  2496 Aug 26 19:24 README
drwxr-xr-x.  2 root root   4096 Dec  9 17:15 scripts
drwxr-xr-x. 27 root root   4096 Dec  9 17:15 share
drwxr-xr-x.  4 root root   4096 Dec  9 17:15 sql-bench
drwxr-xr-x.  2 root root   4096 Dec  9 17:15 support-files
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="修改配置文件与启动文件"><a href="#修改配置文件与启动文件" class="header-anchor">#</a> 修改配置文件与启动文件</h3> <p>因为是多实例，其中参数需要修改，修改后的配置文件如下</p> <h3 id="配置文件my-cnf"><a href="#配置文件my-cnf" class="header-anchor">#</a> 配置文件my.cnf</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[client]
port = 3307
socket = /data/3307/mysql.sock
[mysql]
no-auto-rehash
[mysqld] user = mysql
port = 3307
socket = /data/3307/mysql.sock
basedir = /application/mysql
datadir = /data/3307/data
\#log_long_format
\#log-error = /data/3307/error.log
\#log-slow-queries = /data/3307/slow.log
pid-file = /data/3307/mysql.pid
server-id = 3    
[mysqld_safe]
log-error=/data/3307/mysql3307.err
pid-file=/data/3307/mysqld.pid
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="启动程序文件mysql"><a href="#启动程序文件mysql" class="header-anchor">#</a> 启动程序文件mysql</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@backup 3307]# cat mysql
\#!/bin/sh
init port=3307
mysql_user=&quot;root&quot;
mysql_pwd=&quot;migongge&quot;
CmdPath=&quot;/application/mysql/bin&quot;
mysql_sock=&quot;/data/${port}/mysql.sock&quot;
\#startup
function_start_mysql() {
if [ ! -e &quot;$mysql_sock&quot; ];then
   printf &quot;Starting MySQL...\n&quot;
/bin/sh ${CmdPath}/mysqld_safe --defaults-file=/data/${port}/my.cnf 2&gt;&amp;1 &gt; /dev/null &amp;
else
  printf &quot;MySQL is running...\n&quot;
exit
fi
}
\#stop function
function_stop_mysql() {
if [ ! -e &quot;$mysql_sock&quot; ];then
printf &quot;MySQL is stopped...\n&quot;
exit
else
printf &quot;Stoping MySQL...\n&quot;
${CmdPath}/mysqladmin -u ${mysql_user} -p${mysql_pwd} -S /data/${port}/mysql.sock shutdown
fi
}

\#restart function
function_restart_mysql() {
   printf &quot;Restarting MySQL...\n&quot;
   function_stop_mysql
   sleep 2
   function_start_mysql
}
case $1 in
start)
function_start_mysql
;;
stop)
function_stop_mysql
;;
restart)
function_restart_mysql
;;
*)
printf &quot;Usage: /data/${port}/mysql {start|stop|restart}\n&quot;
esac
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>其它的配置可参考配置文件进行修改即可</p> <h3 id="多实例初始化操作"><a href="#多实例初始化操作" class="header-anchor">#</a> 多实例初始化操作</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@centos6 3306]# /application/mysql/scripts/mysql_install_db  	basedir=/application/mysql --datadir=/data/3306/data --user=mysql
Installing MySQL system tables...
161209 18:02:17 [Warning] 'THREAD_CONCURRENCY' is deprecated and will be removed in a future release.
161209 18:02:17 [Note] /application/mysql/bin/mysqld (mysqld 5.5.52-log) starting as process 3336 ...
OK
Filling help tables...
161209 18:02:17 [Warning] 'THREAD_CONCURRENCY' is deprecated and will be removed in a future release.
161209 18:02:17 [Note] /application/mysql/bin/mysqld (mysqld 5.5.52-log) starting as process 3343 ...
OK
To start mysqld at boot time you have to copy
support-files/mysql.server to the right place for your system
PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !
To do so, start the server, then issue the following commands:
/application/mysql/bin/mysqladmin -u root password 'new-password'
/application/mysql/bin/mysqladmin -u root -h centos6 password 'new-password'
Alternatively you can run:
/application/mysql/bin/mysql_secure_installation
which will also give you the option of removing the test
databases and anonymous user created by default.  This is
strongly recommended for production servers.
See the manual for more instructions
You can start the MySQL daemon with:
cd /application/mysql ; /application/mysql/bin/mysqld_safe &amp;
You can test the MySQL daemon with mysql-test-run.pl
cd /application/mysql/mysql-test ; perl mysql-test-run.pl
Please report any problems at http://bugs.mysql.com/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>初始化成功后，会在数据目录下产生一个数据目录data和一些文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@centos6 3306]# ll /data/3306/data/
total 1136
drwx------. 2 mysql root     4096 Dec  9 18:02 mysql
-rw-rw----. 1 mysql mysql   27693 Dec  9 18:02 mysql-bin.000001
-rw-rw----. 1 mysql mysql 1114546 Dec  9 18:02 mysql-bin.000002
-rw-rw----. 1 mysql mysql      38 Dec  9 18:02 mysql-bin.index
drwx------. 2 mysql mysql    4096 Dec  9 18:02 performance_schema
drwx------. 2 mysql root     4096 Dec  9 18:02 test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>另一个实例的初始化请参考上述操作进行，操作过程不再一一介绍</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@centos6 3307]# ll /data/3307/data/
total 1136
drwx------. 2 mysql root     4096 Dec  9 18:40 mysql
-rw-rw----. 1 mysql mysql   27693 Dec  9 18:40 mysql-bin.000001
-rw-rw----. 1 mysql mysql 1114546 Dec  9 18:40 mysql-bin.000002
-rw-rw----. 1 mysql mysql      38 Dec  9 18:40 mysql-bin.index
drwx------. 2 mysql mysql    4096 Dec  9 18:40 performance_schema
drwx------. 2 mysql root     4096 Dec  9 18:40 test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_4-、启动多实例并登录"><a href="#_4-、启动多实例并登录" class="header-anchor">#</a> 4 、启动多实例并登录</h2> <h3 id="启动服务"><a href="#启动服务" class="header-anchor">#</a> 启动服务</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@backup 3307]# /data/3306/mysql start
Starting MySQL...
[root@backup 3307]# lsof -i :3306
COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME
mysqld 19986 mysql 10u IPv4 90967 0t0 TCP *:mysql (LISTEN)
[root@backup 3307]# /data/3307/mysql
start Starting MySQL...
[root@backup 3307]# lsof -i :3307
COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME
mysqld 21648 mysql 11u IPv4 92899 0t0 TCP *:opsession-prxy (LISTEN)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="检查端口"><a href="#检查端口" class="header-anchor">#</a> 检查端口</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@backup 3307]# netstat -lntup|grep mysql
tcp 0 0 0.0.0.0:3307 0.0.0.0:* LISTEN 21648/mysqld
tcp 0 0 0.0.0.0:3306 0.0.0.0:* LISTEN 19986/mysqld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="登陆多实例数据库"><a href="#登陆多实例数据库" class="header-anchor">#</a> 登陆多实例数据库</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@backup ~]# mysql -S /data/3306/mysql.sock
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><section style="border-top:2px solid #eaecef;padding-top:1rem;margin-top:2rem;"><div><span data-flag-title="Your Article Title" class="leancloud-visitors"><em class="post-meta-item-text">阅读量： </em> <i class="leancloud-visitors-count"></i></span></div> <h3><a href="javascript:;"></a>
    评 论：
  </h3> <div id="vcomments"></div></section></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/views/Linux/SQL/Mysql-Basics.html" class="prev">
            Mysql常用基础命令
          </a></span> <!----></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#_1、什么是多实例" class="sidebar-link reco-side-_1、什么是多实例" data-v-70334359>1、什么是多实例</a></li><li class="level-2" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#_2、安装多实例环境准备" class="sidebar-link reco-side-_2、安装多实例环境准备" data-v-70334359>2、安装多实例环境准备</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#安装程序" class="sidebar-link reco-side-安装程序" data-v-70334359>安装程序</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#创建安装用户" class="sidebar-link reco-side-创建安装用户" data-v-70334359>创建安装用户</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#创建多实例的数据目录" class="sidebar-link reco-side-创建多实例的数据目录" data-v-70334359>创建多实例的数据目录</a></li><li class="level-2" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#_3、安装mysql多实例" class="sidebar-link reco-side-_3、安装mysql多实例" data-v-70334359>3、安装MYSQL多实例</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#解压软件" class="sidebar-link reco-side-解压软件" data-v-70334359>解压软件</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#拷贝配置文件" class="sidebar-link reco-side-拷贝配置文件" data-v-70334359>拷贝配置文件</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#修改配置文件与启动文件" class="sidebar-link reco-side-修改配置文件与启动文件" data-v-70334359>修改配置文件与启动文件</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#配置文件my-cnf" class="sidebar-link reco-side-配置文件my-cnf" data-v-70334359>配置文件my.cnf</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#启动程序文件mysql" class="sidebar-link reco-side-启动程序文件mysql" data-v-70334359>启动程序文件mysql</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#多实例初始化操作" class="sidebar-link reco-side-多实例初始化操作" data-v-70334359>多实例初始化操作</a></li><li class="level-2" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#_4-、启动多实例并登录" class="sidebar-link reco-side-_4-、启动多实例并登录" data-v-70334359>4 、启动多实例并登录</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#启动服务" class="sidebar-link reco-side-启动服务" data-v-70334359>启动服务</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#检查端口" class="sidebar-link reco-side-检查端口" data-v-70334359>检查端口</a></li><li class="level-3" data-v-70334359><a href="/views/Linux/SQL/MySQL-duoshili.html#登陆多实例数据库" class="sidebar-link reco-side-登陆多实例数据库" data-v-70334359>登陆多实例数据库</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="left:10px;bottom:190px;display:none;" data-v-5775ee02>
      我是蚝仔烙欢迎你的关注 
    </div> <div class="operation" style="left:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="240" height="352" class="live2d" style="left:80px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div></div></div>
    <script src="/assets/js/app.cb239607.js" defer></script><script src="/assets/js/3.b5031865.js" defer></script><script src="/assets/js/1.21311c90.js" defer></script><script src="/assets/js/21.382df535.js" defer></script><script src="/assets/js/15.f0eedfb9.js" defer></script>
  </body>
</html>
